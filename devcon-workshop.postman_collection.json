{
	"info": {
		"_postman_id": "5d9c044b-3bc4-4314-8354-504fb11287a0",
		"name": "Ballerine Fintech Devcon Workshop Collection",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "28301812",
		"_collection_link": "https://ballerine.postman.co/workspace/Team-Workspace~5c79afc3-8ea0-425b-830f-f2d931784837/collection/28301812-5d9c044b-3bc4-4314-8354-504fb11287a0?action=share&source=collection_link&creator=28301812"
	},
	"item": [
		{
			"name": "1. Workflow Definition - (Update Collection Form)",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"states\": {\n        \"data_collection\": {\n            \"metadata\": {\n                \"uiSettings\": {\n                    \"multiForm\": {\n                        \"documents\": [\n                            {\n                                \"id\": \"url-document\",\n                                \"type\": \"url\",\n                                \"name\": \"customDocument\",\n                                \"provider\": \"http\",\n                                \"properties\": {\n                                    \"type\": \"Custom\",\n                                    \"category\": \"Document\"\n                                }\n                            }\n                        ],\n                        \"steps\": [\n                            {\n                                \"id\": \"companyInformation\",\n                                \"formSchema\": {\n                                    \"properties\": {\n                                        \"website\": {\n                                            \"type\": \"string\",\n                                            \"title\": \"Company Website\"\n                                        }\n                                    }\n                                },\n                                \"uiSchema\": {\n                                    \"website\": {\n                                        \"ui:placeholder\": \"https://google.com\"\n                                    }\n                                }\n                            },\n                            {\n                                \"id\": \"businessDocuments\",\n                                \"formSchema\": {\n                                    \"properties\": {\n                                        \"customDocument\": {\n                                            \"type\": \"string\",\n                                            \"title\": \"Document Url\"\n                                        }\n                                    }\n                                }\n                            }\n                        ]\n                    }\n                }\n            }\n        }\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/workflow-definition/devcon_example_workflow",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"workflow-definition",
						"devcon_example_workflow"
					]
				}
			},
			"response": []
		},
		{
			"name": "2. Workflow Definition - (Add Steps)",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"states\": {\n        \"data_collection\": {\n            \"on\": {\n                \"start\": \"process_documents\"\n            }\n        },\n        \"process_documents\": {\n            \"on\": {\n                \"API_CALL_SUCCESS\": [\n                    {\n                        \"target\": \"manual_review\"\n                    }\n                ],\n                \"API_CALL_ERROR\": [\n                    {\n                        \"target\": \"manual_review\"\n                    }\n                ]\n            }\n        }\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/workflow-definition/devcon_example_workflow?arrayMergeStrategy=by_index",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"workflow-definition",
						"devcon_example_workflow"
					],
					"query": [
						{
							"key": "arrayMergeStrategy",
							"value": "by_index"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "3. Workflow Definition - (Add Plugin)",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"extensions\": {\n        \"apiPlugins\": [\n            {\n                \"name\": \"llm_ocr_extraction\",\n                \"pluginKind\": \"api\",\n                \"url\": \"https://unified-api-test.eu.ballerine.app/ocr/extract\",\n                \"method\": \"POST\",\n                \"headers\": {\n                    \"authorization\": \"Bearer {secret.UNIFIED_API_TOKEN}\"\n                },\n                \"stateNames\": [\n                    \"process_documents\"\n                ],\n                \"successAction\": \"API_CALL_SUCCESS\",\n                \"errorAction\": \"API_CALL_ERROR\",\n                \"request\": {\n                    \"transform\": [\n                        {\n                            \"transformer\": \"jmespath\",\n                            \"mapping\": \"{images: [{remote: {imageUri: entity.data.dynamicInfo.companyDocuments.customDocument}}]}\"\n                        }\n                    ],\n                    \"schema\": {\n                        \"type\": \"object\",\n                        \"properties\": {\n                            \"unifiedSocialCreditCode\": {\n                                \"type\": \"string\"\n                            },\n                            \"companyName\": {\n                                \"type\": \"string\"\n                            },\n                            \"address\": {\n                                \"type\": \"object\",\n                                \"properties\": {\n                                    \"country\": {\n                                        \"type\":\"string\"\n                                    },\n                                    \"city\": {\n                                        \"type\":\"string\"\n                                    },\n                                    \"street\": {\n                                        \"type\":\"string\"\n                                    }\n                                }\n                            },\n                            \"expiryDate\": {\n                                \"type\":\"string\"\n                            }\n                        }\n                    }\n                },\n                \"response\": {\n                    \"transform\": [\n                        {\n                            \"transformer\": \"jmespath\",\n                            \"mapping\": \"@\"\n                        }\n                    ]                    \n                }\n            }\n        ]\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/workflow-definition/devcon_example_workflow",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"workflow-definition",
						"devcon_example_workflow"
					]
				}
			},
			"response": []
		},
		{
			"name": "4. Workflow Definition - (Add A Rule For Auto Approve)",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"states\": {\n        \"data_collection\": {\n            \"on\": {\n                \"start\": \"process_documents\"\n            }\n        },\n        \"process_documents\": {\n            \"on\": {\n                \"API_CALL_SUCCESS\": [\n                    {\n                        \"target\": \"approved\",\n                        \"cond\": {\n                            \"type\": \"json-logic\",\n                            \"options\": {\n                                \"rule\": {\n                                    \"==\": [\n                                        {\n                                            \"var\": \"pluginsOutput.llm_ocr_extraction.parsedData.unifiedSocialCreditCode\"\n                                        },\n                                          {\n                                            \"var\": \"entity.data.registrationNumber\"\n                                        }\n                                    ]\n                                }\n                            }\n                        }\n                    },\n                    {\n                        \"target\": \"manual_review\"\n                    }\n                ],\n                \"API_CALL_ERROR\": [\n                    {\n                        \"target\": \"manual_review\"\n                    }\n                ]\n            }\n        }\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/workflow-definition/devcon_example_workflow?arrayMergeStrategy=by_index",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"workflow-definition",
						"devcon_example_workflow"
					],
					"query": [
						{
							"key": "arrayMergeStrategy",
							"value": "by_index"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "5. Workflow Definition - (Add Webhook)",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"extensions\": {\n        \"apiPlugins\": [\n            {\n                \"name\": \"webhook_final_results\",\n                \"url\": \"https://webhook.site/91f5bfc1-79d2-4fea-b9d6-a0fe7ce905d5\",\n                \"method\": \"POST\",\n                \"stateNames\": [\n                    \"approved\",\n                    \"rejected\"\n                ],\n                \"request\": {\n                    \"transform\": [\n                        {\n                            \"transformer\": \"jmespath\",\n                            \"mapping\": \"{workflow_decision: state, data: @}\"\n                        }\n                    ]\n                }\n            }\n        ]\n     \n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/workflow-definition/devcon_example_workflow?arrayMergeStrategy=concat",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"workflow-definition",
						"devcon_example_workflow"
					],
					"query": [
						{
							"key": "arrayMergeStrategy",
							"value": "concat"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Helper: Get Workflow Definition",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/workflow-definition/devcon_example_workflow1",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"workflow-definition",
						"devcon_example_workflow1"
					]
				}
			},
			"response": []
		},
		{
			"name": "1.1.(temp) Workflow RUN",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"workflowId\": \"devcon_example_workflow1\",\n    \"context\": {\n        \"entity\": {\n            \"id\": \"company_id_9212221\",\n            \"data\": {\n                \"companyName\": \"shadabzxcvmh4567t\"\n            },\n            \"type\": \"business\"\n        },\n        \"documents\": [\n            {\n                \"category\": \"proof_of_Address\",\n                \"type\": \"water_bill\",\n                \"issuer\": {\n                    \"country\": \"Gh\"\n                },\n                \"pages\": [\n                    {\n                        \"provider\": \"http\",\n                        \"uri\": \"https://realestate-resources.scdn2.secure.raxcdn.com/wp-content/uploads/2018/09/Understand-Water-Sewage-Bill-Japan-Kanji-Cheat-Sheet-Real-Estate-Japan-1024x614.jpg\",\n                        \"metadata\": {\n                            \"side\": \"front\",\n                            \"pageNumber\": \"1\"\n                        },\n                        \"type\": \"pdf\"\n                    }\n                ],\n                \"properties\": {\n                    \"docNumber\": \"1234\",\n                    \"userAddress\": \"Turkey, buhgdawe\"\n                },\n                \"version\": \"1\",\n                \"issuingVersion\": 1\n            },\n            {\n                \"category\": \"proof_of_Address\",\n                \"type\": \"water_bill\",\n                \"issuer\": {\n                    \"country\": \"Gh\"\n                },\n                \"pages\": [\n                    {\n                        \"provider\": \"http\",\n                        \"uri\": \"https://realestate-resources.scdn2.secure.raxcdn.com/wp-content/uploads/2018/09/Understand-Water-Sewage-Bill-Japan-Kanji-Cheat-Sheet-Real-Estate-Japan-1024x614.jpg\",\n                        \"metadata\": {\n                            \"side\": \"front\",\n                            \"pageNumber\": \"1\"\n                        },\n                        \"type\": \"pdf\"\n                    }\n                ],\n                \"properties\": {\n                    \"docNumber\": \"1234\",\n                    \"userAddress\": \"Turkey, buhgdawe\"\n                },\n                \"version\": 20,\n                \"issuingVersion\": 1\n            }\n        ]\n    },\n    \"config\": {\n        \"subscriptions\": [\n            {\n                \"type\": \"webhook\",\n                \"url\": \"https://webhook.site/e57257b0-e645-40a6-bf7f-1e904acd9995\",\n                \"events\": [\n                    \"workflow.context.document.changed\"\n                ]\n            }\n        ]\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/run",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"run"
					]
				}
			},
			"response": []
		},
		{
			"name": "1.2(temp) Workflow Start",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "secret",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"start\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:3000/api/v1/external/workflows/cllo1pyu20006ru0gn0252yf0/send-event",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"api",
						"v1",
						"external",
						"workflows",
						"cllo1pyu20006ru0gn0252yf0",
						"send-event"
					]
				}
			},
			"response": []
		}
	]
}